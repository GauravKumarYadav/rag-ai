<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile & Settings</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --accent: #22d3ee;
            --accent-hover: #06b6d4;
            --accent-glow: rgba(34, 211, 238, 0.4);
            --accent-dim: rgba(34, 211, 238, 0.15);
            --primary: #22d3ee;
            --primary-hover: #06b6d4;
            --bg: #030712;
            --bg-secondary: #0a0f1a;
            --panel: #111827;
            --elevated: #1f2937;
            --muted: #6b7280;
            --text: #f9fafb;
            --text-secondary: #9ca3af;
            --border: #1f2937;
            --success: #34d399;
            --error: #f87171;
            --warning: #fbbf24;
            --radius: 12px;
            --shadow: 0 12px 30px rgba(0,0,0,0.5);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
            font-family: 'Outfit', -apple-system, sans-serif; 
            background: var(--bg); 
            color: var(--text); 
            min-height: 100vh;
        }
        
        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background: 
                radial-gradient(circle at 0% 0%, var(--accent-dim) 0%, transparent 50%),
                radial-gradient(circle at 100% 100%, rgba(168, 85, 247, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }
        
        a { color: inherit; text-decoration: none; }

        .app { display: grid; grid-template-rows: auto 1fr; height: 100vh; position: relative; z-index: 1; }
        header { 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            padding: 16px 24px; 
            border-bottom: 1px solid var(--border); 
            background: var(--bg-secondary); 
            position: sticky; 
            top: 0; 
            z-index: 10;
            backdrop-filter: blur(10px);
        }
        .brand { display: flex; align-items: center; gap: 12px; font-weight: 700; letter-spacing: 0.4px; }
        .brand-badge { 
            width: 40px; 
            height: 40px; 
            border-radius: var(--radius); 
            background: linear-gradient(135deg, var(--accent), #a855f7); 
            display: grid; 
            place-items: center; 
            font-weight: 800; 
            box-shadow: 0 0 20px var(--accent-glow);
            color: var(--bg);
        }
        nav { display: flex; gap: 8px; flex-wrap: wrap; }
        .tab { 
            padding: 10px 16px; 
            border-radius: var(--radius); 
            background: transparent; 
            color: var(--text-secondary); 
            border: 1px solid transparent; 
            cursor: pointer; 
            transition: all 0.2s ease;
            font-family: inherit;
            font-size: 0.875rem;
        }
        .tab.active { 
            background: var(--accent-dim); 
            color: var(--accent); 
            border-color: rgba(34, 211, 238, 0.3); 
            box-shadow: 0 0 20px var(--accent-glow);
        }
        .tab:hover:not(.active) { 
            color: var(--text); 
            border-color: var(--border);
            background: var(--panel);
        }
        .actions { display: flex; gap: 10px; align-items: center; }
        .pill { 
            padding: 8px 14px; 
            border-radius: 999px; 
            background: var(--accent-dim); 
            color: var(--accent); 
            border: 1px solid rgba(34, 211, 238, 0.2); 
            font-size: 13px;
            font-weight: 500;
        }
        button.btn { 
            border: none; 
            cursor: pointer; 
            border-radius: var(--radius); 
            padding: 10px 18px; 
            background: linear-gradient(135deg, var(--accent), var(--accent-hover)); 
            color: var(--bg); 
            font-family: inherit;
            font-weight: 600; 
            transition: all 0.2s ease;
            box-shadow: 0 2px 10px var(--accent-glow);
        }
        button.btn:hover { 
            transform: translateY(-1px);
            box-shadow: 0 4px 20px var(--accent-glow);
        }
        button.btn.secondary { 
            background: var(--panel); 
            color: var(--text); 
            border: 1px solid var(--border);
            box-shadow: none;
        }
        button.btn.secondary:hover { 
            border-color: var(--accent);
            transform: translateY(-1px);
        }
        button.btn.danger {
            background: linear-gradient(135deg, var(--error), #dc2626);
            box-shadow: 0 2px 10px rgba(248, 113, 113, 0.3);
        }
        .btn-link { 
            background: transparent; 
            color: var(--text-secondary); 
            border: none; 
            cursor: pointer; 
            display: flex; 
            align-items: center; 
            gap: 6px; 
            font-size: 13px; 
            font-family: inherit;
            transition: 0.2s;
            padding: 8px 12px;
            border-radius: var(--radius);
        }
        .btn-link:hover { 
            color: var(--accent);
            background: var(--accent-dim);
        }

        .grid { 
            display: grid; 
            gap: 20px; 
            padding: 24px; 
            grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
            overflow-y: auto;
        }
        .panel { 
            background: var(--bg-secondary); 
            border: 1px solid var(--border); 
            border-radius: var(--radius); 
            box-shadow: var(--shadow); 
            padding: 20px; 
            min-height: 200px;
            transition: all 0.2s ease;
        }
        .panel:hover {
            border-color: rgba(34, 211, 238, 0.2);
        }
        .panel h3 { 
            margin-bottom: 16px; 
            font-size: 1rem; 
            letter-spacing: 0.2px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .panel h3 i {
            color: var(--accent);
        }
        .panel .muted { color: var(--muted); font-size: 13px; }

        .table { width: 100%; border-collapse: collapse; margin-top: 12px; font-size: 14px; }
        .table th, .table td { padding: 12px; text-align: left; border-bottom: 1px solid var(--border); }
        .table th { color: var(--muted); font-weight: 600; font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.05em; }
        .table tr:hover td { background: var(--panel); }
        .table code { 
            font-family: 'JetBrains Mono', monospace;
            background: var(--panel);
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            color: var(--accent);
        }

        .stat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px,1fr)); gap: 16px; }
        .stat { 
            padding: 16px; 
            border-radius: var(--radius); 
            border: 1px solid var(--border); 
            background: var(--panel); 
            box-shadow: var(--shadow);
            transition: all 0.2s ease;
        }
        .stat:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
        }
        .stat .label { color: var(--muted); font-size: 12px; text-transform: uppercase; letter-spacing: 0.5px; }
        .stat .value { 
            font-size: 24px; 
            font-weight: 700; 
            margin-top: 8px;
            background: linear-gradient(135deg, var(--text), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px,1fr)); gap: 16px; margin-top: 16px; }
        label { 
            font-size: 0.75rem; 
            color: var(--text-secondary); 
            display: block; 
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 500;
        }
        input, select { 
            width: 100%; 
            padding: 12px 14px; 
            border-radius: var(--radius); 
            border: 1.5px solid var(--border); 
            background: var(--bg); 
            color: var(--text);
            font-family: inherit;
            font-size: 0.9375rem;
            transition: all 0.2s ease;
        }
        input:focus, select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 4px var(--accent-dim);
        }
        input::placeholder {
            color: var(--muted);
        }
        .chip { 
            display: inline-block; 
            padding: 4px 10px; 
            border-radius: 999px; 
            background: var(--accent-dim); 
            color: var(--accent); 
            font-size: 12px; 
            border: 1px solid rgba(34, 211, 238, 0.2);
            font-weight: 500;
        }

        .profile-card { display: flex; align-items: center; gap: 24px; padding: 24px; }
        .profile-avatar { 
            width: 88px; 
            height: 88px; 
            border-radius: 50%; 
            background: linear-gradient(135deg, var(--accent), #a855f7); 
            display: grid; 
            place-items: center; 
            font-size: 36px; 
            font-weight: 700; 
            color: var(--bg); 
            box-shadow: 0 0 30px var(--accent-glow);
        }
        .profile-info { flex: 1; }
        .profile-info h2 { 
            font-size: 1.75rem; 
            margin-bottom: 6px;
            background: linear-gradient(135deg, var(--text), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .profile-info .role-badge { 
            display: inline-flex; 
            align-items: center; 
            gap: 6px; 
            padding: 6px 14px; 
            border-radius: 999px; 
            font-size: 12px; 
            font-weight: 600;
        }
        .role-badge.admin { 
            background: rgba(52, 211, 153, 0.15); 
            color: var(--success); 
            border: 1px solid rgba(52, 211, 153, 0.3);
        }
        .role-badge.user { 
            background: var(--accent-dim); 
            color: var(--accent); 
            border: 1px solid rgba(34, 211, 238, 0.3);
        }

        .hidden { display: none; }
        .badge-success { color: var(--success); }
        .badge-error { color: var(--error); }
        
        /* Scrollbar styling */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg); }
        ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--muted); }
    </style>
</head>
<body>
<div id="app" class="app hidden">
    <header>
        <div class="brand">
            <div class="brand-badge">P</div>
            <div>Profile & Settings</div>
        </div>
        <nav id="tabs"></nav>
        <div class="actions">
            <button class="btn-link" onclick="window.location.href='/'">
                <i class="fa fa-comments"></i> Back to Chat
            </button>
            <div id="userBadge" class="pill">-</div>
            <button class="btn secondary" id="logoutBtn">Logout</button>
        </div>
    </header>

    <main id="content"></main>
</div>

<script>
    // Use same origin for API calls (nginx proxies to backend)
    const API_BASE = window.location.origin;
    const allTabs = [
        { id: 'profile', label: 'Profile', icon: 'fa-user', adminOnly: false },
        { id: 'clients', label: 'Clients', icon: 'fa-building', adminOnly: false },
        { id: 'audit', label: 'Audit Logs', icon: 'fa-list-check', adminOnly: true },
        { id: 'users', label: 'Users', icon: 'fa-user-shield', adminOnly: true },
        { id: 'evaluation', label: 'Evaluation', icon: 'fa-vial', adminOnly: true },
        { id: 'stats', label: 'Stats', icon: 'fa-chart-line', adminOnly: true },
    ];
    
    function getVisibleTabs() {
        if (currentUserInfo && currentUserInfo.is_superuser) {
            return allTabs;
        }
        return allTabs.filter(t => !t.adminOnly);
    }

    let authToken = localStorage.getItem('auth_token');
    let currentTab = 'profile'; // Default to profile

    const appView = document.getElementById('app');
    const logoutBtn = document.getElementById('logoutBtn');
    const userBadge = document.getElementById('userBadge');
    const content = document.getElementById('content');
    const tabsContainer = document.getElementById('tabs');

    function redirectToLogin() {
        window.location.href = '/login?redirect=' + encodeURIComponent(window.location.pathname);
    }

    function rebuildTabs() {
        const visibleTabs = getVisibleTabs();
        tabsContainer.innerHTML = visibleTabs.map(t => `<button class="tab" data-id="${t.id}"><i class="fa ${t.icon}"></i> ${t.label}</button>`).join('');
        
        // If current tab is not visible, switch to first available tab
        if (!visibleTabs.find(t => t.id === currentTab)) {
            currentTab = visibleTabs[0]?.id || 'profile';
        }
    }
    
    tabsContainer.addEventListener('click', (e) => {
        const btn = e.target.closest('button.tab');
        if (!btn) return;
        currentTab = btn.dataset.id;
        renderTabs();
        loadTab();
    });

    logoutBtn.addEventListener('click', () => {
        authToken = null;
        localStorage.removeItem('auth_token');
        localStorage.removeItem('user');
        redirectToLogin();
    });

    function getHeaders() {
        return { 'Content-Type': 'application/json', Authorization: `Bearer ${authToken}` };
    }

    let currentUserInfo = null;
    
    async function bootstrap() {
        // If no token, redirect to login
        if (!authToken) {
            redirectToLogin();
            return;
        }
        
        try {
            const me = await fetch(`${API_BASE}/auth/me`, { headers: getHeaders() });
            if (!me.ok) throw new Error('Auth failed');
            const user = await me.json();
            currentUserInfo = user;
            userBadge.textContent = user.username || 'user';
            userBadge.title = user.is_superuser ? 'Admin' : 'Regular User';
            if (user.is_superuser) {
                userBadge.style.background = 'rgba(16, 185, 129, 0.2)';
                userBadge.style.borderColor = 'rgba(16, 185, 129, 0.4)';
            } else {
                userBadge.style.background = 'rgba(239, 68, 68, 0.2)';
                userBadge.style.borderColor = 'rgba(239, 68, 68, 0.4)';
            }
            appView.classList.remove('hidden');
            renderTabs();
            loadTab();
        } catch (err) {
            // Auth failed, redirect to login
            localStorage.removeItem('auth_token');
            localStorage.removeItem('user');
            redirectToLogin();
        }
    }

    function renderTabs() {
        rebuildTabs();
        Array.from(tabsContainer.querySelectorAll('.tab')).forEach(btn => {
            btn.classList.toggle('active', btn.dataset.id === currentTab);
        });
    }
    
    function renderAdminWarning() {
        return '';
    }
    
    function renderUserInfo() {
        if (currentUserInfo && !currentUserInfo.is_superuser) {
            return `<div style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 10px; padding: 10px 14px; margin-bottom: 16px; display: flex; align-items: center; gap: 10px; font-size: 13px;">
                <i class="fa fa-info-circle" style="color: var(--primary);"></i>
                <span>Logged in as <strong>${currentUserInfo.username}</strong>. You can manage clients from this page.</span>
            </div>`;
        }
        return '';
    }

    async function loadTab() {
        if (currentTab === 'profile') return renderProfile();
        if (currentTab === 'audit') return renderAudit();
        if (currentTab === 'users') return renderUsers();
        if (currentTab === 'clients') return renderClients();
        if (currentTab === 'evaluation') return renderEvaluation();
        if (currentTab === 'stats') return renderStats();
    }

    // ============================================================
    // PROFILE TAB
    // ============================================================
    async function renderProfile() {
        const user = currentUserInfo;
        const initials = user.username ? user.username.substring(0, 2).toUpperCase() : 'U';
        const roleClass = user.is_superuser ? 'admin' : 'user';
        const roleText = user.is_superuser ? 'Administrator' : 'User';
        
        content.innerHTML = `
            <div class="grid">
                <div class="panel" style="grid-column: 1 / -1;">
                    <div class="profile-card">
                        <div class="profile-avatar">${initials}</div>
                        <div class="profile-info">
                            <h2>${user.username}</h2>
                            <div class="muted" style="margin-bottom: 8px;">${user.email || 'No email set'}</div>
                            <span class="role-badge ${roleClass}">
                                <i class="fa ${user.is_superuser ? 'fa-shield-halved' : 'fa-user'}"></i>
                                ${roleText}
                            </span>
                        </div>
                    </div>
                </div>
                
                <div class="panel">
                    <h3><i class="fa fa-info-circle" style="margin-right: 8px;"></i>Account Details</h3>
                    <table class="table">
                        <tbody>
                            <tr><td class="muted" style="width: 140px;">User ID</td><td><code style="background: #162033; padding: 4px 8px; border-radius: 6px; font-size: 12px;">${user.id}</code></td></tr>
                            <tr><td class="muted">Username</td><td>${user.username}</td></tr>
                            <tr><td class="muted">Email</td><td>${user.email || '<span class="muted">Not set</span>'}</td></tr>
                            <tr><td class="muted">Role</td><td><span class="chip">${roleText}</span></td></tr>
                            <tr><td class="muted">Status</td><td><span class="${user.is_active !== false ? 'badge-success' : 'badge-error'}">${user.is_active !== false ? 'Active' : 'Inactive'}</span></td></tr>
                            <tr><td class="muted">Created</td><td>${user.created_at ? new Date(user.created_at).toLocaleString() : '-'}</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="panel">
                    <h3><i class="fa fa-key" style="margin-right: 8px;"></i>Change Password</h3>
                    <div class="form-grid" style="grid-template-columns: 1fr;">
                        <div>
                            <label>Current Password</label>
                            <input id="currentPass" type="password" placeholder="Enter current password">
                        </div>
                        <div>
                            <label>New Password</label>
                            <input id="newPass" type="password" placeholder="Enter new password">
                        </div>
                        <div>
                            <label>Confirm New Password</label>
                            <input id="confirmPass" type="password" placeholder="Confirm new password">
                        </div>
                    </div>
                    <div style="margin-top: 12px;">
                        <button class="btn" id="changePassBtn">Update Password</button>
                        <span id="passMsg" class="muted" style="margin-left: 10px;"></span>
                    </div>
                </div>
                
                <div class="panel">
                    <h3><i class="fa fa-sliders" style="margin-right: 8px;"></i>Quick Actions</h3>
                    <div style="display: flex; flex-direction: column; gap: 10px; margin-top: 12px;">
                        <button class="btn secondary" onclick="window.location.href='/'">
                            <i class="fa fa-comments"></i> Go to Chat
                        </button>
                        ${user.is_superuser ? `
                        <button class="btn secondary" onclick="currentTab='users'; renderTabs(); loadTab();">
                            <i class="fa fa-user-shield"></i> Manage Users
                        </button>
                        <button class="btn secondary" onclick="currentTab='stats'; renderTabs(); loadTab();">
                            <i class="fa fa-chart-line"></i> View Stats
                        </button>
                        ` : ''}
                        <button class="btn secondary" onclick="currentTab='clients'; renderTabs(); loadTab();">
                            <i class="fa fa-building"></i> Manage Clients
                        </button>
                    </div>
                </div>
            </div>
        `;
        
        // Password change handler
        document.getElementById('changePassBtn').addEventListener('click', async () => {
            const currentPass = document.getElementById('currentPass').value;
            const newPass = document.getElementById('newPass').value;
            const confirmPass = document.getElementById('confirmPass').value;
            const msg = document.getElementById('passMsg');
            
            if (!currentPass || !newPass) {
                msg.textContent = 'Please fill in all fields';
                msg.className = 'muted badge-error';
                return;
            }
            
            if (newPass !== confirmPass) {
                msg.textContent = 'New passwords do not match';
                msg.className = 'muted badge-error';
                return;
            }
            
            if (newPass.length < 6) {
                msg.textContent = 'Password must be at least 6 characters';
                msg.className = 'muted badge-error';
                return;
            }
            
            msg.textContent = 'Updating...';
            msg.className = 'muted';
            
            try {
                // First verify current password by trying to login
                const loginRes = await fetch(`${API_BASE}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username: currentUserInfo.username, password: currentPass }),
                });
                
                if (!loginRes.ok) {
                    msg.textContent = 'Current password is incorrect';
                    msg.className = 'muted badge-error';
                    return;
                }
                
                // Update password via admin endpoint (for self) or dedicated endpoint
                const res = await fetch(`${API_BASE}/auth/change-password`, {
                    method: 'POST',
                    headers: getHeaders(),
                    body: JSON.stringify({ current_password: currentPass, new_password: newPass }),
                });
                
                if (!res.ok) {
                    const err = await res.json().catch(() => ({}));
                    throw new Error(err.detail || 'Failed to update password');
                }
                
                msg.textContent = 'Password updated successfully!';
                msg.className = 'muted badge-success';
                document.getElementById('currentPass').value = '';
                document.getElementById('newPass').value = '';
                document.getElementById('confirmPass').value = '';
            } catch (err) {
                msg.textContent = err.message;
                msg.className = 'muted badge-error';
            }
        });
    }

    // ============================================================
    // AUDIT TAB
    // ============================================================
    async function renderAudit() {
        content.innerHTML = `${renderAdminWarning()}<div class="grid" style="grid-template-columns: 1fr;">
            <div class="panel">
                <h3>Audit Log Filters</h3>
                <div class="form-grid" style="grid-template-columns: repeat(5, 1fr);">
                    <div><label>Username</label><input id="filterUser" placeholder="Filter by user" /></div>
                    <div><label>Action</label><select id="filterAction"><option value="">All Actions</option></select></div>
                    <div><label>Method</label><select id="filterMethod"><option value="">All Methods</option><option>GET</option><option>POST</option><option>PUT</option><option>PATCH</option><option>DELETE</option></select></div>
                    <div><label>Status Code</label><input id="filterStatus" type="number" placeholder="e.g. 200" /></div>
                    <div style="display:flex;align-items:flex-end;"><button class="btn" id="applyFilters">Apply</button></div>
                </div>
            </div>
            <div class="panel" id="auditPanel"><h3>Recent Audit Logs</h3><div class="muted">Loading...</div></div>
        </div>`;
        
        try {
            const actRes = await fetch(`${API_BASE}/admin/audit-logs/actions`, { headers: getHeaders() });
            if (actRes.ok) {
                const actions = await actRes.json();
                const select = document.getElementById('filterAction');
                actions.forEach(a => { const opt = document.createElement('option'); opt.value = a; opt.textContent = a; select.appendChild(opt); });
            }
        } catch (e) {}
        
        document.getElementById('applyFilters').addEventListener('click', loadAuditLogs);
        loadAuditLogs();
    }
    
    async function loadAuditLogs() {
        const user = document.getElementById('filterUser')?.value || '';
        const action = document.getElementById('filterAction')?.value || '';
        const method = document.getElementById('filterMethod')?.value || '';
        const status = document.getElementById('filterStatus')?.value || '';
        
        let url = `${API_BASE}/admin/audit-logs?page=1&page_size=50`;
        if (user) url += `&username=${encodeURIComponent(user)}`;
        if (action) url += `&action=${encodeURIComponent(action)}`;
        if (method) url += `&method=${encodeURIComponent(method)}`;
        if (status) url += `&status_code=${status}`;
        
        try {
            const res = await fetch(url, { headers: getHeaders() });
            if (!res.ok) throw new Error('Failed to load logs');
            const data = await res.json();
            const rows = data.items.map(log => `
                <tr>
                    <td>${log.username || '-'}</td>
                    <td><span class="chip">${log.action}</span></td>
                    <td>${log.method || ''} ${log.path || ''}</td>
                    <td class="${log.status_code >= 400 ? 'badge-error' : ''}">${log.status_code || ''}</td>
                    <td>${log.duration_ms ? log.duration_ms.toFixed(0) + 'ms' : '-'}</td>
                    <td>${new Date(log.timestamp).toLocaleString()}</td>
                </tr>
            `).join('');
            document.getElementById('auditPanel').innerHTML = `
                <h3>Audit Logs (${data.total} total)</h3>
                <table class="table">
                    <thead><tr><th>User</th><th>Action</th><th>Path</th><th>Status</th><th>Duration</th><th>When</th></tr></thead>
                    <tbody>${rows || '<tr><td colspan="6" class="muted">No logs found</td></tr>'}</tbody>
                </table>
            `;
        } catch (err) {
            document.getElementById('auditPanel').innerHTML = `<h3>Audit Logs</h3><div class="muted badge-error">${err.message}</div>`;
        }
    }

    // ============================================================
    // USERS TAB
    // ============================================================
    async function renderUsers() {
        content.innerHTML = `${renderAdminWarning()}<div class="grid">
            <div class="panel" id="userList"><h3>Users</h3><div class="muted">Loading...</div></div>
            <div class="panel">
                <h3>Create User</h3>
                <div class="form-grid">
                    <div><label>Username</label><input id="newUser" placeholder="jane" /></div>
                    <div><label>Email</label><input id="newEmail" placeholder="jane@example.com" /></div>
                    <div><label>Password</label><input id="newPass" type="password" /></div>
                    <div><label>Role</label><select id="newRole"><option value="false">User</option><option value="true">Admin</option></select></div>
                </div>
                <div style="margin-top:10px;"><button class="btn" id="createUserBtn">Create</button><span id="userMsg" class="muted" style="margin-left:8px;"></span></div>
            </div>
            <div class="panel" id="editUserPanel" style="display:none;">
                <h3>Edit User</h3>
                <input type="hidden" id="editUserId" />
                <div class="form-grid">
                    <div><label>Email</label><input id="editEmail" placeholder="new@example.com" /></div>
                    <div><label>New Password (leave blank to keep)</label><input id="editPass" type="password" /></div>
                    <div><label>Role</label><select id="editRole"><option value="false">User</option><option value="true">Admin</option></select></div>
                    <div><label>Status</label><select id="editStatus"><option value="true">Active</option><option value="false">Disabled</option></select></div>
                </div>
                <div style="margin-top:10px;">
                    <button class="btn" id="saveUserBtn">Save</button>
                    <button class="btn secondary" id="cancelEditBtn">Cancel</button>
                    <span id="editMsg" class="muted" style="margin-left:8px;"></span>
                </div>
            </div>
        </div>`;

        document.getElementById('createUserBtn').addEventListener('click', async () => {
            const username = document.getElementById('newUser').value.trim();
            const email = document.getElementById('newEmail').value.trim();
            const password = document.getElementById('newPass').value;
            const is_superuser = document.getElementById('newRole').value === 'true';
            const msg = document.getElementById('userMsg');
            msg.textContent = '...';
            try {
                const res = await fetch(`${API_BASE}/admin/users`, {
                    method: 'POST',
                    headers: getHeaders(),
                    body: JSON.stringify({ username, email, password, is_superuser }),
                });
                if (!res.ok) throw new Error((await res.json()).detail || 'Failed');
                msg.textContent = 'User created';
                document.getElementById('newUser').value = '';
                document.getElementById('newEmail').value = '';
                document.getElementById('newPass').value = '';
                loadUserList();
            } catch (err) {
                msg.textContent = err.message;
            }
        });
        
        document.getElementById('saveUserBtn').addEventListener('click', async () => {
            const userId = document.getElementById('editUserId').value;
            const email = document.getElementById('editEmail').value.trim() || null;
            const password = document.getElementById('editPass').value || null;
            const is_superuser = document.getElementById('editRole').value === 'true';
            const is_active = document.getElementById('editStatus').value === 'true';
            const msg = document.getElementById('editMsg');
            msg.textContent = '...';
            try {
                const body = { is_superuser, is_active };
                if (email) body.email = email;
                if (password) body.password = password;
                const res = await fetch(`${API_BASE}/admin/users/${userId}`, {
                    method: 'PATCH',
                    headers: getHeaders(),
                    body: JSON.stringify(body),
                });
                if (!res.ok) throw new Error((await res.json()).detail || 'Failed');
                msg.textContent = 'Updated!';
                document.getElementById('editUserPanel').style.display = 'none';
                loadUserList();
            } catch (err) {
                msg.textContent = err.message;
            }
        });
        
        document.getElementById('cancelEditBtn').addEventListener('click', () => {
            document.getElementById('editUserPanel').style.display = 'none';
        });

        loadUserList();
    }
    
    async function loadUserList() {
        try {
            const res = await fetch(`${API_BASE}/admin/users?limit=100`, { headers: getHeaders() });
            if (!res.ok) throw new Error('Failed to load users');
            const data = await res.json();
            const rows = data.map(u => `
                <tr data-user='${JSON.stringify(u).replace(/'/g, "&#39;")}'>
                    <td>${u.username}</td>
                    <td>${u.email || '-'}</td>
                    <td>${u.is_superuser ? '<span class="badge-success">Admin</span>' : 'User'}</td>
                    <td>${u.is_active ? '<span class="badge-success">Active</span>' : '<span class="badge-error">Disabled</span>'}</td>
                    <td>${u.created_at ? new Date(u.created_at).toLocaleDateString() : '-'}</td>
                    <td><button class="btn secondary edit-user-btn" style="padding:5px 10px;font-size:12px;">Edit</button></td>
                </tr>
            `).join('');
            document.getElementById('userList').innerHTML = `
                <h3>Users (${data.length})</h3>
                <table class="table">
                    <thead><tr><th>Username</th><th>Email</th><th>Role</th><th>Status</th><th>Created</th><th>Actions</th></tr></thead>
                    <tbody>${rows || '<tr><td colspan="6" class="muted">No users</td></tr>'}</tbody>
                </table>
            `;
            
            document.querySelectorAll('.edit-user-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const row = e.target.closest('tr');
                    const user = JSON.parse(row.dataset.user);
                    document.getElementById('editUserId').value = user.id;
                    document.getElementById('editEmail').value = user.email || '';
                    document.getElementById('editPass').value = '';
                    document.getElementById('editRole').value = user.is_superuser ? 'true' : 'false';
                    document.getElementById('editStatus').value = user.is_active ? 'true' : 'false';
                    document.getElementById('editUserPanel').style.display = 'block';
                    document.getElementById('editMsg').textContent = `Editing: ${user.username}`;
                });
            });
        } catch (err) {
            document.getElementById('userList').innerHTML = `<h3>Users</h3><div class="muted badge-error">${err.message}</div>`;
        }
    }

    // ============================================================
    // CLIENTS TAB
    // ============================================================
    let allUsers = []; // Cache users list for assignment UI
    
    async function renderClients() {
        const isAdmin = currentUserInfo && currentUserInfo.is_superuser;
        
        content.innerHTML = `${renderUserInfo()}<div class="grid">
            <div class="panel" id="clientList" style="grid-column: 1 / -1;"><h3>Clients</h3><div class="muted">Loading...</div></div>
            ${isAdmin ? `
            <div class="panel">
                <h3><i class="fa fa-plus-circle" style="color: var(--success);"></i> Create Client</h3>
                <div class="form-grid">
                    <div><label>Name</label><input id="newClientName" placeholder="Acme Corp" /></div>
                    <div><label>Aliases (comma-separated)</label><input id="newClientAliases" placeholder="acme, acme-corp" /></div>
                </div>
                <div style="margin-top:10px;"><button class="btn" id="createClientBtn">Create</button><span id="clientMsg" class="muted" style="margin-left:8px;"></span></div>
            </div>
            <div class="panel" id="userAccessPanel">
                <h3><i class="fa fa-user-plus" style="color: var(--accent);"></i> User Access Management</h3>
                <div class="form-grid">
                    <div>
                        <label>Select Client</label>
                        <select id="accessClientSelect" style="width:100%;padding:10px;border-radius:var(--radius);border:1px solid var(--border);background:var(--bg);color:var(--text);">
                            <option value="">-- Select a client --</option>
                        </select>
                    </div>
                    <div>
                        <label>Select User</label>
                        <select id="accessUserSelect" style="width:100%;padding:10px;border-radius:var(--radius);border:1px solid var(--border);background:var(--bg);color:var(--text);">
                            <option value="">-- Select a user --</option>
                        </select>
                    </div>
                </div>
                <div style="margin-top:10px;display:flex;gap:8px;">
                    <button class="btn" id="assignUserBtn"><i class="fa fa-plus"></i> Grant Access</button>
                    <button class="btn secondary" id="revokeUserBtn" style="color:var(--error);"><i class="fa fa-minus"></i> Revoke Access</button>
                </div>
                <div id="accessMsg" class="muted" style="margin-top:8px;"></div>
                <div id="clientUsersPreview" style="margin-top:16px;"></div>
            </div>
            ` : ''}
        </div>`;

        if (isAdmin) {
            document.getElementById('createClientBtn').addEventListener('click', async () => {
                const name = document.getElementById('newClientName').value.trim();
                const aliasesStr = document.getElementById('newClientAliases').value.trim();
                const aliases = aliasesStr ? aliasesStr.split(',').map(a => a.trim()).filter(a => a) : [];
                const msg = document.getElementById('clientMsg');
                msg.textContent = '...';
                try {
                    const res = await fetch(`${API_BASE}/clients`, {
                        method: 'POST',
                        headers: getHeaders(),
                        body: JSON.stringify({ name, aliases, metadata: {} }),
                    });
                    if (!res.ok) throw new Error((await res.json()).detail || 'Failed');
                    msg.textContent = 'Client created';
                    msg.className = 'muted badge-success';
                    document.getElementById('newClientName').value = '';
                    document.getElementById('newClientAliases').value = '';
                    loadClientList();
                } catch (err) {
                    msg.textContent = err.message;
                    msg.className = 'muted badge-error';
                }
            });
            
            // User access management
            document.getElementById('assignUserBtn').addEventListener('click', assignUserToClient);
            document.getElementById('revokeUserBtn').addEventListener('click', revokeUserFromClient);
            document.getElementById('accessClientSelect').addEventListener('change', loadClientUsersPreview);
            
            // Load users for dropdown
            loadUsersForAccessPanel();
        }

        loadClientList();
    }
    
    async function loadUsersForAccessPanel() {
        try {
            const res = await fetch(`${API_BASE}/admin/users?limit=200`, { headers: getHeaders() });
            if (res.ok) {
                allUsers = await res.json();
                const userSelect = document.getElementById('accessUserSelect');
                if (userSelect) {
                    userSelect.innerHTML = '<option value="">-- Select a user --</option>';
                    allUsers.forEach(u => {
                        const opt = document.createElement('option');
                        opt.value = u.id;
                        opt.textContent = `${u.username} ${u.is_superuser ? '(Admin)' : ''}`;
                        userSelect.appendChild(opt);
                    });
                }
            }
        } catch (err) {
            console.error('Failed to load users:', err);
        }
    }
    
    async function assignUserToClient() {
        const clientId = document.getElementById('accessClientSelect').value;
        const userId = document.getElementById('accessUserSelect').value;
        const msg = document.getElementById('accessMsg');
        
        if (!clientId || !userId) {
            msg.textContent = 'Please select both a client and a user';
            msg.className = 'muted badge-error';
            return;
        }
        
        msg.textContent = 'Assigning...';
        msg.className = 'muted';
        
        try {
            const res = await fetch(`${API_BASE}/clients/${clientId}/users/${userId}`, {
                method: 'POST',
                headers: getHeaders(),
            });
            
            if (res.ok) {
                const data = await res.json();
                msg.textContent = data.message || 'User assigned successfully';
                msg.className = 'muted badge-success';
                loadClientUsersPreview();
            } else {
                const err = await res.json();
                throw new Error(err.detail || 'Failed to assign user');
            }
        } catch (err) {
            msg.textContent = err.message;
            msg.className = 'muted badge-error';
        }
    }
    
    async function revokeUserFromClient() {
        const clientId = document.getElementById('accessClientSelect').value;
        const userId = document.getElementById('accessUserSelect').value;
        const msg = document.getElementById('accessMsg');
        
        if (!clientId || !userId) {
            msg.textContent = 'Please select both a client and a user';
            msg.className = 'muted badge-error';
            return;
        }
        
        if (!confirm('Are you sure you want to revoke this user\'s access to this client?')) return;
        
        msg.textContent = 'Revoking...';
        msg.className = 'muted';
        
        try {
            const res = await fetch(`${API_BASE}/clients/${clientId}/users/${userId}`, {
                method: 'DELETE',
                headers: getHeaders(),
            });
            
            if (res.ok) {
                msg.textContent = 'Access revoked successfully';
                msg.className = 'muted badge-success';
                loadClientUsersPreview();
            } else {
                const err = await res.json();
                throw new Error(err.detail || 'Failed to revoke access');
            }
        } catch (err) {
            msg.textContent = err.message;
            msg.className = 'muted badge-error';
        }
    }
    
    async function loadClientUsersPreview() {
        const clientId = document.getElementById('accessClientSelect').value;
        const preview = document.getElementById('clientUsersPreview');
        
        if (!clientId) {
            preview.innerHTML = '';
            return;
        }
        
        preview.innerHTML = '<div class="muted">Loading users...</div>';
        
        try {
            const res = await fetch(`${API_BASE}/clients/${clientId}/users`, { headers: getHeaders() });
            if (res.ok) {
                const data = await res.json();
                const users = data.users || [];
                
                if (users.length === 0) {
                    preview.innerHTML = `
                        <div style="background:var(--panel);border-radius:var(--radius);padding:12px;border:1px solid var(--border);">
                            <div class="muted" style="text-align:center;">
                                <i class="fa fa-users" style="font-size:1.5rem;margin-bottom:8px;display:block;"></i>
                                No users have access to this client yet
                            </div>
                        </div>
                    `;
                } else {
                    const userChips = users.map(u => `
                        <span class="chip" style="margin:2px;display:inline-flex;align-items:center;gap:4px;">
                            <i class="fa fa-user" style="font-size:10px;"></i>
                            ${u.username}
                            ${u.is_superuser ? '<i class="fa fa-shield" style="font-size:10px;color:var(--success);" title="Admin"></i>' : ''}
                        </span>
                    `).join('');
                    
                    preview.innerHTML = `
                        <div style="background:var(--panel);border-radius:var(--radius);padding:12px;border:1px solid var(--border);">
                            <div style="font-size:0.75rem;text-transform:uppercase;letter-spacing:0.05em;color:var(--muted);margin-bottom:8px;">
                                Users with access (${users.length})
                            </div>
                            <div>${userChips}</div>
                        </div>
                    `;
                }
            }
        } catch (err) {
            preview.innerHTML = `<div class="muted badge-error">Failed to load users</div>`;
        }
    }

    async function loadClientList() {
        const isAdmin = currentUserInfo && currentUserInfo.is_superuser;
        
        try {
            const res = await fetch(`${API_BASE}/clients`, { headers: getHeaders() });
            if (!res.ok) throw new Error('Failed to load clients');
            const data = await res.json();
            const clients = data.clients || [];
            
            // Update access panel dropdown
            const accessSelect = document.getElementById('accessClientSelect');
            if (accessSelect) {
                accessSelect.innerHTML = '<option value="">-- Select a client --</option>';
                clients.forEach(c => {
                    const opt = document.createElement('option');
                    opt.value = c.id;
                    opt.textContent = c.name;
                    accessSelect.appendChild(opt);
                });
            }
            
            const rows = clients.map(c => `
                <tr>
                    <td title="${c.id}"><code style="font-size:11px;background:var(--panel);padding:2px 6px;border-radius:4px;">${c.id.substring(0, 8)}...</code></td>
                    <td><strong>${c.name}</strong></td>
                    <td>${c.aliases?.join(', ') || '<span class="muted">-</span>'}</td>
                    <td>${c.created_at ? new Date(c.created_at).toLocaleDateString() : '-'}</td>
                    <td>
                        ${isAdmin ? `
                        <button class="btn secondary view-users-btn" data-id="${c.id}" data-name="${c.name}" style="padding:5px 10px;font-size:12px;margin-right:4px;">
                            <i class="fa fa-users"></i>
                        </button>
                        <button class="btn secondary delete-client-btn" data-id="${c.id}" data-name="${c.name}" style="padding:5px 10px;font-size:12px;color:#ef4444;">
                            <i class="fa fa-trash"></i>
                        </button>
                        ` : '-'}
                    </td>
                </tr>
            `).join('');
            
            document.getElementById('clientList').innerHTML = `
                <h3><i class="fa fa-building" style="margin-right:8px;"></i>Clients (${clients.length})</h3>
                <table class="table">
                    <thead><tr><th>ID</th><th>Name</th><th>Aliases</th><th>Created</th><th>Actions</th></tr></thead>
                    <tbody>${rows || '<tr><td colspan="5" class="muted">No clients</td></tr>'}</tbody>
                </table>
            `;
            
            if (isAdmin) {
                document.querySelectorAll('.delete-client-btn').forEach(btn => {
                    btn.addEventListener('click', async (e) => {
                        const clientId = btn.dataset.id;
                        const clientName = btn.dataset.name;
                        if (!confirm(`Delete client "${clientName}"?\n\nThis will NOT delete their documents. To also delete documents, use delete_documents=true parameter.`)) return;
                        
                        try {
                            const res = await fetch(`${API_BASE}/clients/${clientId}?delete_documents=false`, {
                                method: 'DELETE',
                                headers: getHeaders(),
                            });
                            if (!res.ok) throw new Error((await res.json()).detail || 'Failed');
                            loadClientList();
                        } catch (err) {
                            alert('Delete failed: ' + err.message);
                        }
                    });
                });
                
                document.querySelectorAll('.view-users-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const clientId = btn.dataset.id;
                        document.getElementById('accessClientSelect').value = clientId;
                        loadClientUsersPreview();
                        // Scroll to access panel
                        document.getElementById('userAccessPanel').scrollIntoView({ behavior: 'smooth' });
                    });
                });
            }
        } catch (err) {
            document.getElementById('clientList').innerHTML = `<h3>Clients</h3><div class="muted badge-error">${err.message}</div>`;
        }
    }

    // ============================================================
    // EVALUATION TAB
    // ============================================================
    async function renderEvaluation() {
        content.innerHTML = `${renderAdminWarning()}<div class="grid">
            <div class="panel" id="datasetPanel"><h3>Datasets</h3><div class="muted">Loading...</div></div>
            <div class="panel" id="runPanel"><h3>Runs</h3><div class="muted">Loading...</div></div>
            <div class="panel">
                <h3>Generate Dataset</h3>
                <div class="form-grid">
                    <div><label>Name</label><input id="dsName" placeholder="Daily sample" /></div>
                    <div><label>Client Id (optional)</label><input id="dsClient" placeholder="client-123" /></div>
                    <div><label>Sample Size</label><input id="dsSize" type="number" min="1" max="500" placeholder="50" /></div>
                </div>
                <div style="margin-top:10px;"><button class="btn" id="genBtn">Generate</button><span id="genMsg" class="muted" style="margin-left:8px;"></span></div>
            </div>
            <div class="panel">
                <h3>Run Evaluation</h3>
                <div class="form-grid">
                    <div><label>Dataset Id</label><input id="runDataset" type="number" /></div>
                    <div><label>k</label><input id="runK" type="number" value="5" min="1" max="20" /></div>
                </div>
                <div style="margin-top:10px;"><button class="btn" id="runBtn">Run</button><span id="runMsg" class="muted" style="margin-left:8px;"></span></div>
            </div>
        </div>`;

        document.getElementById('genBtn').addEventListener('click', async () => {
            const name = document.getElementById('dsName').value.trim();
            const client_id = document.getElementById('dsClient').value.trim() || null;
            const sample_size = parseInt(document.getElementById('dsSize').value, 10) || null;
            const msg = document.getElementById('genMsg');
            msg.textContent = '...';
            try {
                const res = await fetch(`${API_BASE}/evaluation/datasets`, {
                    method: 'POST',
                    headers: getHeaders(),
                    body: JSON.stringify({ name, client_id, sample_size }),
                });
                if (!res.ok) throw new Error((await res.json()).detail || 'Failed');
                msg.textContent = 'Dataset created';
                renderEvaluation();
            } catch (err) {
                msg.textContent = err.message;
            }
        });

        document.getElementById('runBtn').addEventListener('click', async () => {
            const dataset_id = parseInt(document.getElementById('runDataset').value, 10);
            const k = parseInt(document.getElementById('runK').value, 10) || 5;
            const msg = document.getElementById('runMsg');
            msg.textContent = '...';
            try {
                const res = await fetch(`${API_BASE}/evaluation/runs`, {
                    method: 'POST',
                    headers: getHeaders(),
                    body: JSON.stringify({ dataset_id, k }),
                });
                if (!res.ok) throw new Error((await res.json()).detail || 'Failed');
                msg.textContent = 'Run completed';
                renderEvaluation();
            } catch (err) {
                msg.textContent = err.message;
            }
        });

        try {
            const dsRes = await fetch(`${API_BASE}/evaluation/datasets`, { headers: getHeaders() });
            const datasets = dsRes.ok ? await dsRes.json() : [];
            const dsRows = datasets.map(d => `
                <tr>
                    <td>${d.id}</td><td>${d.name}</td><td>${d.client_id || '-'}</td><td>${d.sample_size}</td><td>${d.qa_pairs_count}</td><td>${d.run_count || 0}</td>
                </tr>
            `).join('');
            document.getElementById('datasetPanel').innerHTML = `
                <h3>Datasets</h3>
                <table class="table">
                    <thead><tr><th>ID</th><th>Name</th><th>Client</th><th>Sample</th><th>Q&A</th><th>Runs</th></tr></thead>
                    <tbody>${dsRows || '<tr><td colspan="6" class="muted">No datasets</td></tr>'}</tbody>
                </table>
            `;
        } catch (err) {
            document.getElementById('datasetPanel').innerHTML = `<h3>Datasets</h3><div class="muted badge-error">${err.message}</div>`;
        }

        try {
            const runRes = await fetch(`${API_BASE}/evaluation/runs`, { headers: getHeaders() });
            const runs = runRes.ok ? await runRes.json() : [];
            const runRows = runs.map(r => {
                const m = r.metrics || {};
                return `
                <tr>
                    <td>${r.id}</td>
                    <td>${r.dataset_name || r.dataset_id}</td>
                    <td><span class="chip">${r.status || 'completed'}</span></td>
                    <td>${m.mean_precision_at_k?.toFixed?.(3) || '-'}</td>
                    <td>${m.mean_recall_at_k?.toFixed?.(3) || '-'}</td>
                    <td>${m.mean_mrr?.toFixed?.(3) || '-'}</td>
                    <td>${m.hit_rate?.toFixed?.(3) || '-'}</td>
                    <td>${r.created_at ? new Date(r.created_at).toLocaleString() : ''}</td>
                </tr>
            `}).join('');
            document.getElementById('runPanel').innerHTML = `
                <h3>Evaluation Runs (${runs.length})</h3>
                <table class="table">
                    <thead><tr><th>ID</th><th>Dataset</th><th>Status</th><th>Precision@k</th><th>Recall@k</th><th>MRR</th><th>Hit Rate</th><th>Created</th></tr></thead>
                    <tbody>${runRows || '<tr><td colspan="8" class="muted">No runs yet</td></tr>'}</tbody>
                </table>
            `;
        } catch (err) {
            document.getElementById('runPanel').innerHTML = `<h3>Runs</h3><div class="muted badge-error">${err.message}</div>`;
        }
    }

    // ============================================================
    // STATS TAB
    // ============================================================
    async function renderStats() {
        content.innerHTML = `${renderAdminWarning()}<div class="grid">
            <div class="panel" id="statPanel"><h3>Key Stats</h3><div class="muted">Loading...</div></div>
            <div class="panel" id="configPanel"><h3>Config</h3><div class="muted">Loading...</div></div>
        </div>`;
        try {
            const res = await fetch(`${API_BASE}/admin/stats`, { headers: getHeaders() });
            const data = res.ok ? await res.json() : {};
            document.getElementById('statPanel').innerHTML = `
                <h3>Key Stats</h3>
                <div class="stat-grid">
                    <div class="stat"><div class="label">Users</div><div class="value">${data.total_users ?? '-'}</div></div>
                    <div class="stat"><div class="label">Active Users</div><div class="value">${data.active_users ?? '-'}</div></div>
                    <div class="stat"><div class="label">Admins</div><div class="value">${data.superusers ?? '-'}</div></div>
                    <div class="stat"><div class="label">Requests 24h</div><div class="value">${data.total_requests_24h ?? '-'}</div></div>
                    <div class="stat"><div class="label">Error Rate</div><div class="value">${data.error_rate_24h ?? '-'}%</div></div>
                    <div class="stat"><div class="label">Avg Latency</div><div class="value">${data.avg_response_time_ms ?? '-'} ms</div></div>
                </div>
            `;
        } catch (err) {
            document.getElementById('statPanel').innerHTML = `<h3>Key Stats</h3><div class="muted badge-error">${err.message}</div>`;
        }

        try {
            const res = await fetch(`${API_BASE}/admin/config`, { headers: getHeaders() });
            const cfg = res.ok ? await res.json() : {};
            const entries = Object.entries(cfg).map(([k,v]) => `<tr><td>${k}</td><td>${v}</td></tr>`).join('');
            document.getElementById('configPanel').innerHTML = `
                <h3>Config</h3>
                <table class="table">
                    <tbody>${entries || '<tr><td class="muted">No config</td></tr>'}</tbody>
                </table>
            `;
        } catch (err) {
            document.getElementById('configPanel').innerHTML = `<h3>Config</h3><div class="muted badge-error">${err.message}</div>`;
        }
    }

    // Check auth and redirect if needed
    bootstrap();
</script>
</body>
</html>
